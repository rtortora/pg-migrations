{"version":3,"sources":["../../src/commands/do_tidy.js"],"names":["Path","require","FS","module","exports","migrationController","args","config","fileName","readdir","migrationsPath","match","_","year","month","tidyPath","console","log","exists","join","createDirectory","rename","doTidy"],"mappings":";;;;;;AAAA,MAAMA,IAAI,GAAGC,OAAO,CAAC,MAAD,CAApB;;AACA,MAAMC,EAAE,GAAGD,OAAO,CAAC,YAAD,CAAlB;;AAEAE,MAAM,CAACC,OAAP;AAAA;AAAA;AAAA,kCAAiB,WAAsBC,mBAAtB,EAA2CC,IAA3C,EAAiD;AAChE,UAAMC,MAAM,SAASF,mBAAmB,CAACE,MAApB,EAArB;;AACA,SAAK,MAAMC,QAAX,UAA6BN,EAAE,CAACO,OAAH,CAAWF,MAAM,CAACG,cAAlB,CAA7B,EAAgE;AAC9D,YAAMC,KAAK,GAAGH,QAAQ,CAACG,KAAT,CAAe,2BAAf,CAAd;;AACA,UAAI,CAACA,KAAL,EAAY;AACV;AACD;;AACD,YAAM,CAACC,CAAD,EAAIC,IAAJ,EAAUC,KAAV,IAAmBH,KAAzB;AACA,YAAMI,QAAQ,GAAI,GAAEF,IAAK,IAAGC,KAAM,EAAlC;AACAE,MAAAA,OAAO,CAACC,GAAR,CAAYF,QAAZ;;AACA,UAAI,QAAQb,EAAE,CAACgB,MAAH,CAAUlB,IAAI,CAACmB,IAAL,CAAUZ,MAAM,CAACG,cAAjB,EAAiCK,QAAjC,CAAV,CAAR,CAAJ,EAAoE;AAClE,cAAMb,EAAE,CAACkB,eAAH,CAAmBpB,IAAI,CAACmB,IAAL,CAAUZ,MAAM,CAACG,cAAjB,EAAiCK,QAAjC,CAAnB,CAAN;AACD;;AACD,YAAMb,EAAE,CAACmB,MAAH,CACJrB,IAAI,CAACmB,IAAL,CAAUZ,MAAM,CAACG,cAAjB,EAAiCF,QAAjC,CADI,EAEJR,IAAI,CAACmB,IAAL,CAAUZ,MAAM,CAACG,cAAjB,EAAiCK,QAAjC,EAA2CP,QAA3C,CAFI,CAAN;AAID;AACF,GAlBD;;AAAA,WAAgCc,MAAhC;AAAA;AAAA;;AAAA,SAAgCA,MAAhC;AAAA","sourcesContent":["const Path = require('path');\nconst FS = require('async-file');\n\nmodule.exports = async function doTidy(migrationController, args) {\n  const config = await migrationController.config();\n  for (const fileName of await FS.readdir(config.migrationsPath)) {\n    const match = fileName.match(/^(\\d\\d\\d\\d)(\\d\\d).*\\.js$/i);\n    if (!match) {\n      continue;\n    }\n    const [_, year, month] = match;\n    const tidyPath = `${year}-${month}`;\n    console.log(tidyPath);\n    if (!(await FS.exists(Path.join(config.migrationsPath, tidyPath)))) {\n      await FS.createDirectory(Path.join(config.migrationsPath, tidyPath));\n    }\n    await FS.rename(\n      Path.join(config.migrationsPath, fileName),\n      Path.join(config.migrationsPath, tidyPath, fileName)\n    );\n  }\n}\n"],"file":"do_tidy.js"}