{"version":3,"sources":["../../src/commands/do_status.js"],"names":["Table","require","sortBy","module","exports","host","args","migrationStatusMap","sortedKeys","Array","from","keys","key","get","applied","migrated_at","table","head","status","push","local","filename","console","log","toString","doStatus"],"mappings":";;;;;;AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAC,WAAD,CAArB;;AACA,MAAMC,MAAM,GAAGD,OAAO,CAAC,eAAD,CAAtB;;AAEAE,MAAM,CAACC,OAAP;AAAA;AAAA;AAAA,oCAAiB,WAAwBC,IAAxB,EAA8BC,IAA9B,EAAoC;AACnD,UAAMC,kBAAkB,SAASF,IAAI,CAACE,kBAAL,EAAjC;AACA,UAAMC,UAAU,GAAGN,MAAM,CAACO,KAAK,CAACC,IAAN,CAAWH,kBAAkB,CAACI,IAAnB,EAAX,CAAD,EAAwC,CAC9DC,GAAD,IAAO;AAAE,aAAOL,kBAAkB,CAACM,GAAnB,CAAuBD,GAAvB,EAA4BE,OAA5B,GAAsC,CAAtC,GAA0C,CAAjD;AAAoD,KADE,EAE9DF,GAAD,IAAO;AAAE,aAAOL,kBAAkB,CAACM,GAAnB,CAAuBD,GAAvB,EAA4BE,OAA5B,GAAsCP,kBAAkB,CAACM,GAAnB,CAAuBD,GAAvB,EAA4BE,OAA5B,CAAoCC,WAA1E,GAAwFH,GAA/F;AAAoG,KAF9C,CAAxC,CAAzB;AAIA,UAAMI,KAAK,GAAG,IAAIhB,KAAJ,CAAU;AACtBiB,MAAAA,IAAI,EAAE,CAAE,KAAF,EAAS,QAAT,EAAmB,MAAnB;AADgB,KAAV,CAAd;;AAGA,SAAI,IAAIL,GAAR,IAAeJ,UAAf,EAA2B;AACzB,YAAMU,MAAM,GAAGX,kBAAkB,CAACM,GAAnB,CAAuBD,GAAvB,CAAf;AACAI,MAAAA,KAAK,CAACG,IAAN,CAAW,CACTP,GADS,EAETM,MAAM,CAACJ,OAAP,GAAkB,SAAQI,MAAM,CAACJ,OAAP,CAAeC,WAAY,EAArD,GAA0D,MAFjD,EAGTG,MAAM,CAACE,KAAP,GAAeF,MAAM,CAACE,KAAP,CAAaC,QAA5B,GAAwC,iBAH/B,CAAX;AAKD;;AACDC,IAAAA,OAAO,CAACC,GAAR,CAAYP,KAAK,CAACQ,QAAN,EAAZ;AACD,GAlBD;;AAAA,WAAgCC,QAAhC;AAAA;AAAA;;AAAA,SAAgCA,QAAhC;AAAA","sourcesContent":["const Table = require('cli-table');\nconst sortBy = require('lodash.sortby');\n\nmodule.exports = async function doStatus(host, args) {\n  const migrationStatusMap = await host.migrationStatusMap();\n  const sortedKeys = sortBy(Array.from(migrationStatusMap.keys()), [\n    (key)=>{ return migrationStatusMap.get(key).applied ? 0 : 1 },\n    (key)=>{ return migrationStatusMap.get(key).applied ? migrationStatusMap.get(key).applied.migrated_at : key },\n  ]);\n  const table = new Table({\n    head: [ \"Key\", \"Status\", \"Path\" ],\n  });\n  for(let key of sortedKeys) {\n    const status = migrationStatusMap.get(key);\n    table.push([\n      key,\n      status.applied ? `up at ${status.applied.migrated_at}` : `down`,\n      status.local ? status.local.filename : `*** NO FILE ***`,\n    ]);\n  }\n  console.log(table.toString());\n}\n"],"file":"do_status.js"}